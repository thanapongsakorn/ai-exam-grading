venv\Scripts\python : 
C:\Users\usEr\Desktop\
projectnew\app\service
s\ai_service.py:1: 
FutureWarning: 
At line:1 char:1
+ venv\Scripts\python 
scripts\test_batch_gra
ding.py 2>&1 > 
test_output_ ...
+ ~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~
~~~~~
    + CategoryInfo    
          : NotSpeci  
  fied: (C:\Users\u   
 sEr\D...FutureWar    
ning: :String) []    
, RemoteException
    + FullyQualifiedE 
   rrorId : NativeCo  
  mmandError
 

All support for the 
`google.generativeai` 
package has ended. It 
will no longer be 
receiving 
updates or bug fixes. 
Please switch to the 
`google.genai` 
package as soon as 
possible.
See README for more 
details:

https://github.com/goo
gle-gemini/deprecated-
generative-ai-python/b
lob/main/README.md

  import 
google.generativeai 
as genai
Traceback (most 
recent call last):
  File "C:\Users\usEr\
Desktop\projectnew\app
\services\ai_service.p
y", line 87, in 
grade_batch
    response = await s
elf.model.generate_con
tent_async(prompt)
               ^^^^^^^
^^^^^^^^^^^^^^^^^^^^^^
^^^^^^^^^^^^^^^^^^
  File "C:\Users\usEr\
Desktop\projectnew\ven
v\Lib\site-packages\go
ogle\generativeai\gene
rative_models.py", 
line 385, in 
generate_content_async
    response = await s
elf._async_client.gene
rate_content(
               ^^^^^^^
^^^^^^^^^^^^^^^^^^^^^^
^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\usEr\
Desktop\projectnew\ven
v\Lib\site-packages\go
ogle\ai\generativelang
uage_v1beta\services\g
enerative_service\asyn
c_client.py", line 
440, in 
generate_content
    response = await 
rpc(
               
^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\usEr\
Desktop\projectnew\ven
v\Lib\site-packages\go
ogle\api_core\retry\re
try_unary_async.py", 
line 231, in 
retry_wrapped_func
    return await 
retry_target(
           
^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\usEr\
Desktop\projectnew\ven
v\Lib\site-packages\go
ogle\api_core\retry\re
try_unary_async.py", 
line 163, in 
retry_target
    next_sleep = 
_retry_error_helper(
        exc,
    ...<6 lines>...
        timeout,
    )
  File "C:\Users\usEr\
Desktop\projectnew\ven
v\Lib\site-packages\go
ogle\api_core\retry\re
try_base.py", line 
214, in 
_retry_error_helper
    raise final_exc 
from source_exc
  File "C:\Users\usEr\
Desktop\projectnew\ven
v\Lib\site-packages\go
ogle\api_core\retry\re
try_unary_async.py", 
line 158, in 
retry_target
    return await 
target()
           
^^^^^^^^^^^^^^
  File "C:\Users\usEr\
Desktop\projectnew\ven
v\Lib\site-packages\go
ogle\api_core\grpc_hel
pers_async.py", line 
89, in __await__
    raise exceptions.f
rom_grpc_error(rpc_err
or) from rpc_error
google.api_core.except
ions.ResourceExhausted
: 429 You exceeded 
your current quota, 
please check your 
plan and billing 
details. For more 
information on this 
error, head to: https:
//ai.google.dev/gemini
-api/docs/rate-limits.
 To monitor your 
current usage, head 
to: https://ai.dev/rat
e-limit. 
* Quota exceeded for 
metric: generativelang
uage.googleapis.com/ge
nerate_content_free_ti
er_requests, limit: 
20, model: 
gemini-3-flash
Please retry in 
46.723139028s. [links 
{
  description: "Learn 
more about Gemini API 
quotas"
  url: "https://ai.goo
gle.dev/gemini-api/doc
s/rate-limits"
}
, violations {
  quota_metric: "gener
ativelanguage.googleap
is.com/generate_conten
t_free_tier_requests"
  quota_id: "GenerateR
equestsPerDayPerProjec
tPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: 
"gemini-3-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 46
}
]
Traceback (most 
recent call last):
  File "C:\Users\usEr\
Desktop\projectnew\app
\services\ai_service.p
y", line 87, in 
grade_batch
    response = await s
elf.model.generate_con
tent_async(prompt)
               ^^^^^^^
^^^^^^^^^^^^^^^^^^^^^^
^^^^^^^^^^^^^^^^^^
  File "C:\Users\usEr\
Desktop\projectnew\ven
v\Lib\site-packages\go
ogle\generativeai\gene
rative_models.py", 
line 385, in 
generate_content_async
    response = await s
elf._async_client.gene
rate_content(
               ^^^^^^^
^^^^^^^^^^^^^^^^^^^^^^
^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\usEr\
Desktop\projectnew\ven
v\Lib\site-packages\go
ogle\ai\generativelang
uage_v1beta\services\g
enerative_service\asyn
c_client.py", line 
440, in 
generate_content
    response = await 
rpc(
               
^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\usEr\
Desktop\projectnew\ven
v\Lib\site-packages\go
ogle\api_core\retry\re
try_unary_async.py", 
line 231, in 
retry_wrapped_func
    return await 
retry_target(
           
^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\usEr\
Desktop\projectnew\ven
v\Lib\site-packages\go
ogle\api_core\retry\re
try_unary_async.py", 
line 163, in 
retry_target
    next_sleep = 
_retry_error_helper(
        exc,
    ...<6 lines>...
        timeout,
    )
  File "C:\Users\usEr\
Desktop\projectnew\ven
v\Lib\site-packages\go
ogle\api_core\retry\re
try_base.py", line 
214, in 
_retry_error_helper
    raise final_exc 
from source_exc
  File "C:\Users\usEr\
Desktop\projectnew\ven
v\Lib\site-packages\go
ogle\api_core\retry\re
try_unary_async.py", 
line 158, in 
retry_target
    return await 
target()
           
^^^^^^^^^^^^^^
  File "C:\Users\usEr\
Desktop\projectnew\ven
v\Lib\site-packages\go
ogle\api_core\grpc_hel
pers_async.py", line 
89, in __await__
    raise exceptions.f
rom_grpc_error(rpc_err
or) from rpc_error
google.api_core.except
ions.ResourceExhausted
: 429 You exceeded 
your current quota, 
please check your 
plan and billing 
details. For more 
information on this 
error, head to: https:
//ai.google.dev/gemini
-api/docs/rate-limits.
 To monitor your 
current usage, head 
to: https://ai.dev/rat
e-limit. 
* Quota exceeded for 
metric: generativelang
uage.googleapis.com/ge
nerate_content_free_ti
er_requests, limit: 
20, model: 
gemini-3-flash
Please retry in 
45.629544399s. [links 
{
  description: "Learn 
more about Gemini API 
quotas"
  url: "https://ai.goo
gle.dev/gemini-api/doc
s/rate-limits"
}
, violations {
  quota_metric: "gener
ativelanguage.googleap
is.com/generate_conten
t_free_tier_requests"
  quota_id: "GenerateR
equestsPerDayPerProjec
tPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: 
"gemini-3-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 45
}
]
Traceback (most 
recent call last):
  File "C:\Users\usEr\
Desktop\projectnew\app
\services\ai_service.p
y", line 87, in 
grade_batch
    response = await s
elf.model.generate_con
tent_async(prompt)
               ^^^^^^^
^^^^^^^^^^^^^^^^^^^^^^
^^^^^^^^^^^^^^^^^^
  File "C:\Users\usEr\
Desktop\projectnew\ven
v\Lib\site-packages\go
ogle\generativeai\gene
rative_models.py", 
line 385, in 
generate_content_async
    response = await s
elf._async_client.gene
rate_content(
               ^^^^^^^
^^^^^^^^^^^^^^^^^^^^^^
^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\usEr\
Desktop\projectnew\ven
v\Lib\site-packages\go
ogle\ai\generativelang
uage_v1beta\services\g
enerative_service\asyn
c_client.py", line 
440, in 
generate_content
    response = await 
rpc(
               
^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\usEr\
Desktop\projectnew\ven
v\Lib\site-packages\go
ogle\api_core\retry\re
try_unary_async.py", 
line 231, in 
retry_wrapped_func
    return await 
retry_target(
           
^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\usEr\
Desktop\projectnew\ven
v\Lib\site-packages\go
ogle\api_core\retry\re
try_unary_async.py", 
line 163, in 
retry_target
    next_sleep = 
_retry_error_helper(
        exc,
    ...<6 lines>...
        timeout,
    )
  File "C:\Users\usEr\
Desktop\projectnew\ven
v\Lib\site-packages\go
ogle\api_core\retry\re
try_base.py", line 
214, in 
_retry_error_helper
    raise final_exc 
from source_exc
  File "C:\Users\usEr\
Desktop\projectnew\ven
v\Lib\site-packages\go
ogle\api_core\retry\re
try_unary_async.py", 
line 158, in 
retry_target
    return await 
target()
           
^^^^^^^^^^^^^^
  File "C:\Users\usEr\
Desktop\projectnew\ven
v\Lib\site-packages\go
ogle\api_core\grpc_hel
pers_async.py", line 
89, in __await__
    raise exceptions.f
rom_grpc_error(rpc_err
or) from rpc_error
google.api_core.except
ions.ResourceExhausted
: 429 You exceeded 
your current quota, 
please check your 
plan and billing 
details. For more 
information on this 
error, head to: https:
//ai.google.dev/gemini
-api/docs/rate-limits.
 To monitor your 
current usage, head 
to: https://ai.dev/rat
e-limit. 
* Quota exceeded for 
metric: generativelang
uage.googleapis.com/ge
nerate_content_free_ti
er_requests, limit: 
20, model: 
gemini-3-flash
Please retry in 
44.562887197s. [links 
{
  description: "Learn 
more about Gemini API 
quotas"
  url: "https://ai.goo
gle.dev/gemini-api/doc
s/rate-limits"
}
, violations {
  quota_metric: "gener
ativelanguage.googleap
is.com/generate_conten
t_free_tier_requests"
  quota_id: "GenerateR
equestsPerDayPerProjec
tPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: 
"gemini-3-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 44
}
]
DEBUG: Loading Gemini API Key. Length: 39
DEBUG: Key context: AIza...plrw
MongoDB client initialized (connection will be tested on first operation)
Testing Batch Grading (Parallel Optimization)...
AI Batch Grading started for 3 questions.
  Attempt 1: Calling Gemini API...
  Batch attempt 1 failed: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-3-flash
Please retry in 46.723139028s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-3-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 46
}
]
  Attempt 2: Calling Gemini API...
  Batch attempt 2 failed: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-3-flash
Please retry in 45.629544399s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-3-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 45
}
]
  Attempt 3: Calling Gemini API...
  Batch attempt 3 failed: 429 You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/rate-limit. 
* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-3-flash
Please retry in 44.562887197s. [links {
  description: "Learn more about Gemini API quotas"
  url: "https://ai.google.dev/gemini-api/docs/rate-limits"
}
, violations {
  quota_metric: "generativelanguage.googleapis.com/generate_content_free_tier_requests"
  quota_id: "GenerateRequestsPerDayPerProjectPerModel-FreeTier"
  quota_dimensions {
    key: "model"
    value: "gemini-3-flash"
  }
  quota_dimensions {
    key: "location"
    value: "global"
  }
  quota_value: 20
}
, retry_delay {
  seconds: 44
}
]
Batch Result: [{'score': 0, 'feedback': 'เกิดข้อผิดพลาดในการตรวจ'}, {'score': 0, 'feedback': 'เกิดข้อผิดพลาดในการตรวจ'}, {'score': 0, 'feedback': 'เกิดข้อผิดพลาดในการตรวจ'}]
Total time for 3 questions: 2.52 seconds
SUCCESS: Batch Grading is working and efficient!
Disconnected from MongoDB
